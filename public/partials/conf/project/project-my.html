<div class="page-header clearfix">
    <button class="btn btn-primary pull-right" ui-sref="conf.project.create">新增</button></td>
    <h1 class="pull-left m0">我的项目
        <sub><a ui-sref="conf.project" ui-sref-opts="{reload: true}" class="small" >项目列表</a></sub>
    </h1>
</div>

<form class="form-inline" role="form" ng-submit="searchForm(s_projectName)" >
    <div class="form-group">
        <input type="text" ng-model="s_projectName" class="form-control" placeholder="项目名称">
    </div>

    <button type="submit" class="btn btn-default">搜索</button>
</form>

<div class="table-responsive">
    <table class="table table-striped table-hover table-fixed">
        <thead>
        <tr>
            <th width="10%">项目编号</th>
            <th width="20%">项目名称</th>
            <th width="10%">项目模板</th>
            <th width="25%">最近版本</th>
            <th width="25%">最近版本时间</th>
            <th >操作</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="project in projects">
            <td>{{project.id}}</td>
            <td><a tooltip="{{project.name}}" ui-sref="conf.project.detail({id: project.id})">{{project.name}}</a></td>
            <td>
                <template-show tid="{{project.templateId}}"></template-show>
            </td>
            <td >{{project.lastVersion}}
                <a ui-sref="conf.project.version({id: project.id})">all
                    <span ng-if="project.subTotal != 0 ">({{project.subTotal}})</span></a>
            </td>
            <td><span tooltip="{{project.lastUpdated | date:'yyyy-MM-dd HH:mm:ss'}}">{{project.lastUpdated | date:'yyyy-MM-dd HH:mm:ss'}}</span></td>
            <td ng-if="user.role == 'admin'">
                <a  ui-sref="conf.project.edit({id: project.id})" title="修改"><span class="glyphicon glyphicon-edit"></span></a>
                <a ng-click="delete(project.id, $index)" href="" title="删除"><span class="glyphicon glyphicon-remove"></span></a>
            </td>
            <td ng-if="user.role != 'admin'">
                <div ng-if="project.id" has-project-safe="{{project.id}}">
                    <a ng-show="hasProjectSafe_" ui-sref="conf.project.edit({id: project.id})" title="修改"><span class="glyphicon glyphicon-edit"></span></a>
                    <a ng-show="hasProjectSafe_" ng-click="delete(project.id, $index)" href="" title="删除"><span class="glyphicon glyphicon-remove"></span></a>
                </div>
            </td>
        </tr>
        </tbody>
        <tfoot>
        <tr>
            <td colspan="6">&nbsp;</td>
        </tr>
        </tfoot>
    </table>

    <ng-include src="'partials/page.html'"></ng-include>

</div>