templates:
  - name: webapi
    remark: 用于dubbo项目的自动部署，即api类项目
    items:
      - itemName: groupId
        itemDesc: groupId
      - itemName: artifactId
        itemDesc: artifactId
      - itemName: unpacked
        itemDesc: 自动解压
        default: 'False'
    actions:
      - name: 安装
        css: glyphicon glyphicon-play
        versionMenu: True
        steps:
          - name: 安装java
            sls: salt {{machine}} state.sls java.install
            seconds: 17
          - name: 安装tomcat
            sls: salt {{machine}} state.sls tomcat.install
            seconds: 8
          - name: 部署war包
            sls: salt {{machine}} state.sls webapp.deploy pillar={webapp:{"groupId":{{groupId}},"artifactId":{{artifactId}},"version":{{version}},"repository":{{repository}}}}
          - name: 拷贝配置文件
            sls: salt {{machine}} state.sls job.copyfile pillar={job:{"appName":{{appName}},"id":{{jobId}}}
          - name: 启动应用
            sls: salt {{machine}} state.sls tomcat.startup
      - name: 重启
        css: glyphicon glyphicon-repeat
        steps:
          - name: 关闭应用
            sls: salt {{machine}} state.sls tomcat.shutdown
          - name: 启动应用
            sls: salt {{machine}} state.sls tomcat.startup
      - name: 启动
        css: glyphicon glyphicon-play
        steps:
          - name: 启动应用
            sls: salt {{machine}} state.sls tomcat.startup
      - name: 停止
        css: glyphicon glyphicon-stop
        steps:
          - name: 关闭应用
            sls: salt {{machine}} state.sls tomcat.shutdown
  - name: webui
    remark: 用于前端web项目的自动部署，即web类项目
    items:
      - itemName: groupId
        itemDesc: groupId
      - itemName: artifactId
        itemDesc: artifactId
      - itemName: unpacked
        itemDesc: 自动解压
        default: 'False'
    actions:
      - name: 安装
        css: glyphicon glyphicon-play
        versionMenu: True
        steps:
          - name: 安装java
            sls: salt {{machine}} state.sls java.install
            seconds: 17
          - name: 安装tomcat
            sls: salt {{machine}} state.sls tomcat.install
            seconds: 8
          - name: 部署war包
            sls: salt {{machine}} state.sls webapp.deploy pillar={webapp:{"groupId":{{groupId}},"artifactId":{{artifactId}},"version":{{version}},"repository":{{repository}}}}
          - name: 拷贝配置文件
            sls: salt {{machine}} state.sls job.copyfile pillar={job:{"appName":{{appName}},"id":{{jobId}}}
          - name: 启动应用
            sls: salt {{machine}} state.sls tomcat.startup
      - name: 重启
        css: glyphicon glyphicon-repeat
        steps:
          - name: 关闭应用
            sls: salt {{machine}} state.sls tomcat.shutdown
          - name: 启动应用
            sls: salt {{machine}} state.sls tomcat.startup
      - name: 启动
        css: glyphicon glyphicon-play
        steps:
          - name: 启动应用
            sls: salt {{machine}} state.sls tomcat.startup
      - name: 停止
        css: glyphicon glyphicon-stop
        steps:
          - name: 关闭应用
            sls: salt {{machine}} state.sls tomcat.shutdown
